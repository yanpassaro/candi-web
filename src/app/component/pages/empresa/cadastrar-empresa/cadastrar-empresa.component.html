<div class="container-sm mb-3 pt-3 ms-lg-auto pe-lg-5">
  <form [formGroup]="empresaForm" (ngSubmit)="onSubmit()" xmlns="http://www.w3.org/1999/html">
    <div class="text-black h3 pt-3">Cadastrar empresa</div>
    <div class="text-sm-end text-form">(*) Obrigatório</div>
    <div *ngIf="ok">
      <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">Cadastro realizado com sucesso</h4>
        <hr>
        <p class="mb-0">CANDI</p>
      </div>
    </div>
    <div *ngIf="error">
      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">{{ message }}</h4>
        <hr>
        <p class="mb-0">CANDI</p>
      </div>
    </div>
    <div class="col">
      <label for="inputNome" class="form-label pt-2">Nome*</label>
      <input type="text" class="form-control" formControlName="nome" id="inputNome" placeholder="Nome">
      <div *ngIf="nome.errors?.['required'] && nome.touched" class="text-danger form-text">Nome obrigatório
      </div>
      <div *ngIf="nome.errors?.['maxlength'] && nome.touched" class="text-danger form-text">Máximo 30 caracteres
      </div>
    </div>

    <div class="col">
      <label for="inputCnpj" class="form-label pt-2">Cnpj*</label>
      <input type="number" class="form-control" formControlName="cnpj" id="inputCnpj" placeholder="CNPJ">
      <div *ngIf="cnpj.errors?.['required'] && cnpj.touched" class="text-danger form-text">CNPJ Obrigatorio
      </div>
      <div *ngIf="cnpj.errors?.['minlength'] && cnpj.touched" class="text-danger form-text">Mínimo 8 caracteres
      </div>
      <div *ngIf="cnpj.errors?.['maxlength'] && cnpj.touched" class="text-danger form-text">Máximo 14 caracteres
      </div>
    </div>

    <div class="col-auto">
      <label for="inputSobre" class="form-label pt-2">Sobre*</label>
      <textarea class="form-control" formControlName="sobre" id="inputSobre" rows="3"></textarea>
      <div *ngIf="sobre.errors?.['maxlength'] && cnpj.touched" class="text-danger form-text">Máximo 500 caracteres
      </div>
    </div>

    <div formGroupName="endereco">
      <div class="text-black h4 pt-2">Endereço</div>
      <div class="row-cols-2">
        <label for="inputCep" class="form-label pt-2">Cep</label>
        <input type="number" class="form-control" formControlName="cep" id="inputCep">
        <div *ngIf="endereco?.get('cep')?.errors?.['required'] && endereco?.get('cep')?.touched"
             class="text-danger form-text">CEP é obrigatório
        </div>
        <div *ngIf="endereco?.get('cep')?.errors?.['minlength'] && endereco?.get('cep')?.touched"
             class="text-danger form-text">CEP deve ter 8 caracteres
        </div>
        <div *ngIf="endereco?.get('cep')?.errors?.['maxlength'] && endereco?.get('cep')?.touched"
             class="text-danger form-text">CEP deve ter 8 caracteres
        </div>
        <label for="inputEstado" class="form-label pt-2">Estado</label>
        <input type="text" class="form-control" formControlName="estado" id="inputEstado">
        <div *ngIf="endereco?.get('estado')?.errors?.['required'] && endereco?.get('estado')?.touched"
             class="text-danger form-text">CNPJ Obrigatório
        </div>
        <label for="inputCidade" class="form-label pt-2">Cidade</label>
        <input type="text" formControlName="cidade" class="form-control" id="inputCidade">
        <div *ngIf="endereco?.get('cidade')?.errors?.['required'] && endereco?.get('cidade')?.touched"
             class="text-danger form-text">CNPJ Obrigatório
        </div>
      </div>
    </div>

    <div formGroupName="contato">
      <div class="text-black h4 pt-2">Contato</div>
      <div class="row-cols-2">
        <label for="inputCep" class="form-label pt-2">Email para contato</label>
        <input type="text" formControlName="email" class="form-control" id="inputEmailContato">
        <div *ngIf="contato?.get('email')?.errors?.['required'] && contato?.get('email')?.touched"
             class="text-danger form-text">Email é obrigatório
        </div>
      </div>
      <label for="inputTelefone" class="form-label pt-2">Telefone</label>
      <input type="number" formControlName="telefone" class="form-control" id="inputTelefone" minlength="14"
             maxlength="14">
      <div
        *ngIf="(contato?.get('telefone')?.touched && contato?.get('telefone')?.errors?.['maxlength']) || (contato?.get('telefone')?.touched && contato?.get('telefone')?.errors?.['minlength'])"
        class="text-danger form-text">Telefone deve ter 14 caracteres
      </div>
      <div class="row-cols-2">
        <label for="inputSite" class="form-label pt-2">Site</label>
        <input type="text" formControlName="site" class="form-control" id="inputSite">
        <div *ngIf="contato?.get('site')?.errors?.['required'] && contato?.get('site')?.touched"
             class="text-danger form-text">Site é obrigatório
        </div>
      </div>
    </div>

    <div formArrayName="administradores">
      <div class="row">
        <div class="col text-black h4 pt-2">Administradores</div>
        <div class="col d-grid d-md-flex justify-content-end pt-2">
          <button type="button" [disabled]="administradores.invalid" class="btn btn-success btn-sm"
                  (click)="addAdministrador()">
            Adicionar
          </button>
        </div>
        <div *ngIf="administradoresMax" class="text-danger h6"> Máximo de administradores cadastradas</div>
      </div>
      <div *ngFor="let administrador of administradores.controls; index as i">
        <div [formGroupName]="i" class="col-auto">
          <div class="row">
            <div class="col">
              <label for="inputAdminNome" class="form-label pt-2">Nome*</label>
              <input type="text" formControlName="nome" class="form-control" id="inputAdminNome">
              <div *ngIf="administrador?.get('nome')?.errors?.['required'] && administrador?.get('nome')?.touched"
                   class="text-danger pt-4 me-3 pe-4 ms-2">Nome é obrigatório
              </div>
            </div>
            <div class="col">
              <label for="inputSobrenome" class="form-label pt-2">Sobrenome*</label>
              <input type="text" formControlName="sobrenome" class="form-control" id="inputSobrenome">
              <div
                *ngIf="administrador?.get('sobrenome')?.errors?.['required'] && administrador?.get('sobrenome')?.touched"
                class="text-danger form-text">Nome é obrigatório
              </div>
            </div>
            <div class="row">
              <div class="col">
                <label for="inputEmailAdmin" class="form-label pt-2">Email*</label>
                <input type="text" class="form-control" formControlName="email" id="inputEmailAdmin">
                <div *ngIf="administrador?.get('email')?.errors?.['required'] && administrador?.get('email')?.touched"
                     class="text-danger pt-4 me-3 pe-4 ms-2">Nome é obrigatório
                </div>
              </div>
              <div *ngIf="administrador?.get('email')?.errors?.['required'] && administrador?.get('email')?.touched"
                   class="text-danger form-text">Nome é obrigatório
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <label for="inputSenha" class="form-label pt-2">Senha*</label>
              <input type="password" class="form-control" formControlName="senha" id="inputSenha" required>
              <div *ngIf="administrador?.get('senha')?.errors?.['required'] && administrador?.get('senha')?.touched"
                   class="text-danger form-text">Senha é obrigatório
              </div>
            </div>
            <div class="col">
              <label for="inputSenha" class="form-label pt-2">Repita a senha*</label>
              <input type="password" class="form-control" formControlName="cSenha" id="inputCSenha">
              <div *ngIf="administrador?.get('senha')?.value != administrador?.get('cSenha')?.value"
                   class="text-danger form-text">Senhas não coincidem
              </div>
            </div>
          </div>
        </div>
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
          <button type="button" class="btn btn-danger btn-sm" (click)="removeAdmin(i)">Remover</button>
        </div>
      </div>
    </div>
    <div class="d-grid gap-2 d-md-flex justify-content-md-start">
      <button type="button" class="btn btn-outline-secondary w10" (click)="voltar()">Voltar ao Inicio</button>
      <input type="submit" class="btn btn-primary w10" value="Cadastrar">
    </div>
  </form>
</div>
